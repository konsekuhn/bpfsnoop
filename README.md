# Syscall Monitor Suite

A collection of tools for monitoring Linux system calls and analyzing the captured data.

## Components

- **syscall_monitor.py**: Main tool for monitoring system calls in real-time
- **filter_logs.py**: Tool for filtering and analyzing log files generated by syscall_monitor
- **Various snoop tools**: Individual monitors for specific syscalls (opensnoop.py, readsnoop.py, etc.)

## Usage

### Monitoring System Calls

The syscall_monitor tool can track multiple system calls simultaneously and log the output to a file:

```bash
# Monitor open and read syscalls with output to terminal and log file
python3 syscall_monitor.py -s open read --logfile syscall_logs.txt

# Monitor all available syscalls
python3 syscall_monitor.py -s open read write connect accept execve recvfrom sendto --logfile all_syscalls.txt

# Monitor specific process by PID
python3 syscall_monitor.py -s open read -p 1234 --logfile proc_1234_syscalls.txt

# Monitor specific user by UID
python3 syscall_monitor.py -s open write -u 1000 --logfile user_1000_syscalls.txt

# Monitor for a specific duration (in seconds)
python3 syscall_monitor.py -s open -d 60 --logfile one_minute_open_calls.txt
```

### Filtering Log Files

Use the filter_logs.py tool to analyze and filter the log files produced by syscall_monitor:

```bash
# Filter logs to show only 'open' syscalls
python3 filter_logs.py --input syscall_logs.txt --syscall open

# Filter logs to show only syscalls from a specific PID
python3 filter_logs.py --input syscall_logs.txt --pid 1234

# Filter logs to show only syscalls from a specific UID
python3 filter_logs.py --input syscall_logs.txt --uid 1000

# Filter logs by timestamp (after a certain time)
python3 filter_logs.py --input syscall_logs.txt --after "2023-01-01 12:00:00"

# Filter logs by timestamp (before a certain time)
python3 filter_logs.py --input syscall_logs.txt --before "2023-01-01 13:00:00"

# Combine multiple filters
python3 filter_logs.py --input syscall_logs.txt --syscall open --pid 1234 --output filtered_logs.txt

# Filter logs containing specific text
python3 filter_logs.py --input syscall_logs.txt --contains "/etc/passwd"
```

## Available Syscall Monitors

- `open`: Monitor file open operations
- `read`: Monitor file read operations
- `write`: Monitor file write operations
- `connect`: Monitor network connection attempts
- `accept`: Monitor incoming network connections
- `execve`: Monitor program execution
- `recvfrom`: Monitor network data reception
- `sendto`: Monitor network data transmission

## Log Format

The log files use the following format for each entry:

```
[TIMESTAMP] SYSCALL=syscall_name data1 data2 ...
additional lines of data...
```

Each entry begins with a timestamp and syscall identifier, followed by specific data for that syscall.

## Requirements

- Linux kernel 4.9 or later
- Python 3.6 or later
- BCC (BPF Compiler Collection) 